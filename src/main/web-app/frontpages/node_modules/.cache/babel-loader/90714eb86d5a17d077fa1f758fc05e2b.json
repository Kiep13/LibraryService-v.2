{"ast":null,"code":"var _jsxFileName = \"D:\\\\libraryservice\\\\frontpages\\\\src\\\\components\\\\registration\\\\registration-page.js\";\nimport React, { Component } from 'react';\nimport './registration-page.css';\nimport { compose } from \"../../utils\";\nimport { connect } from \"react-redux\";\nimport { Link } from 'react-router-dom';\nimport withLibraryService from \"../../hoc\";\nimport { withRouter } from \"react-router\";\nimport { registrationsClearFields, registrationUpdateLoginField, registrationUpdatePasswordField, registrationUpdateRepeatPasswordField } from \"../../actions/registration-actions\";\n\nclass RegistrationPage extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      isLoginError: false,\n      isPasswordError: false,\n      isRepeatPasswordError: false\n    };\n    this.regExpLogin = new RegExp(\"^[A-Za-zА-Яа-я0-9]+$\");\n    this.regExpPassword = new RegExp(\"^[A-Za-zА-Яа-я0-9]+$\");\n    this.errorLoginMessage = \"The username must be at least 4 characters long\";\n    this.errorPasswordMessage = \"The password must be at least 8 characters and must contain letters in different case and numbers\";\n    this.errorRepeatPasswordMessage = \"Repeat password must match the value entered above\";\n\n    this.validateLogin = (login, isErrorField) => {\n      let isError = !this.regExpLogin.test(login);\n      isError = !isError ? login.length < 4 : isError;\n      this.changeErrorState(isErrorField, isError);\n    };\n\n    this.validatePassword = (password, isErrorField) => {\n      let isError = !this.regExpPassword.test(password);\n      isError = !isError ? password.length < 8 : isError;\n      this.changeErrorState(isErrorField, isError);\n    };\n\n    this.validateRepeatPassword = (repeatPassword, isErrorField) => {\n      let isError = !this.regExpPassword.test(repeatPassword);\n      isError = !isError ? repeatPassword.length < 8 || repeatPassword.localeCompare(this.props.passwordField) : isError;\n      this.changeErrorState(isErrorField, isError);\n    };\n\n    this.changeErrorState = (isErrorField, value) => {\n      this.setState({\n        [isErrorField]: value\n      });\n    };\n\n    this.loginChange = event => {\n      event.preventDefault();\n      this.validateLogin(event.target.value, \"isLoginError\");\n      this.props.changeLogin(event.target.value);\n    };\n\n    this.passwordChange = event => {\n      event.preventDefault();\n      this.validatePassword(event.target.value, \"isPasswordError\");\n      this.props.changePassword(event.target.value);\n    };\n\n    this.repeatPasswordChange = event => {\n      event.preventDefault();\n      this.validateRepeatPassword(event.target.value, \"isRepeatPasswordError\");\n      this.props.changeRepeatPassword(event.target.value);\n    };\n\n    this.onSubmit = async event => {\n      event.preventDefault();\n      const {\n        loginField,\n        passwordField,\n        repeatPasswordField\n      } = this.props;\n      await this.validateLogin(loginField, \"isLoginError\");\n      await this.validatePassword(passwordField, \"isPasswordError\");\n      await this.validateRepeatPassword(repeatPasswordField, \"isRepeatPasswordError\");\n      const isError = this.state.isLoginError || this.state.isPasswordError || this.state.isRepeatPasswordError;\n\n      if (!isError) {\n        const admin = {\n          login: loginField,\n          password: passwordField\n        };\n        let result = await this.props.libraryService.addAdmin(admin);\n        console.log(result);\n\n        if (result) {\n          this.props.history.push('/authorization');\n        } else {\n          alert(\"Get some problems when trying add user\");\n        }\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.props.clearFields();\n  }\n\n  render() {\n    const styleLoginField = this.state.isLoginError ? \"form-control red-box\" : \"form-control\";\n    const stylePasswordField = this.state.isPasswordError ? \"form-control red-box\" : \"form-control\";\n    const styleRepeatPasswordField = this.state.isRepeatPasswordError ? \"form-control red-box\" : \"form-control\";\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"reg-screen\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"reg-block align-middle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"reg-header ml-4 pl-2 mr-5 pr-3 mt-2 d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-outline-dark float-left item-control\",\n      to: \"/authorization\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-arrow-left\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 29\n      }\n    })), /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"align-baseline\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 25\n      }\n    }, \"Registration\")), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.onSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"label-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 25\n      }\n    }, \"Login\", /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Write your future login\",\n      className: styleLoginField,\n      onChange: this.loginChange,\n      value: this.props.loginField,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 29\n      }\n    })), this.state.isLoginError ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"red-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 52\n      }\n    }, this.errorLoginMessage) : null, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"label-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 25\n      }\n    }, \"Password\", /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      placeholder: \"Write your future password\",\n      className: stylePasswordField,\n      onChange: this.passwordChange,\n      value: this.props.passwordField,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 29\n      }\n    })), this.state.isPasswordError ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"red-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 55\n      }\n    }, this.errorPasswordMessage) : null, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"label-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 25\n      }\n    }, \"Confirm password\", /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      placeholder: \"Repeat your password\",\n      className: styleRepeatPasswordField,\n      onChange: this.repeatPasswordChange,\n      value: this.props.repeatField,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 29\n      }\n    })), this.state.isRepeatPasswordError ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"red-text\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 61\n      }\n    }, this.errorRepeatPasswordMessage) : null, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-info auth-button mb-3 mt-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 25\n      }\n    }, \"Registration\"))));\n  }\n\n}\n\nconst mapStateToProps = ({\n  registrationBlock\n}) => {\n  return {\n    loginField: registrationBlock.loginField,\n    passwordField: registrationBlock.passwordField,\n    repeatPasswordField: registrationBlock.repeatPasswordField\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    clearFields: () => {\n      dispatch(registrationsClearFields());\n    },\n    changeLogin: value => {\n      dispatch(registrationUpdateLoginField(value));\n    },\n    changePassword: value => {\n      dispatch(registrationUpdatePasswordField(value));\n    },\n    changeRepeatPassword: value => {\n      dispatch(registrationUpdateRepeatPasswordField(value));\n    }\n  };\n};\n\nexport default compose(withRouter, withLibraryService(), connect(mapStateToProps, mapDispatchToProps))(RegistrationPage);","map":{"version":3,"sources":["D:/libraryservice/frontpages/src/components/registration/registration-page.js"],"names":["React","Component","compose","connect","Link","withLibraryService","withRouter","registrationsClearFields","registrationUpdateLoginField","registrationUpdatePasswordField","registrationUpdateRepeatPasswordField","RegistrationPage","state","isLoginError","isPasswordError","isRepeatPasswordError","regExpLogin","RegExp","regExpPassword","errorLoginMessage","errorPasswordMessage","errorRepeatPasswordMessage","validateLogin","login","isErrorField","isError","test","length","changeErrorState","validatePassword","password","validateRepeatPassword","repeatPassword","localeCompare","props","passwordField","value","setState","loginChange","event","preventDefault","target","changeLogin","passwordChange","changePassword","repeatPasswordChange","changeRepeatPassword","onSubmit","loginField","repeatPasswordField","admin","result","libraryService","addAdmin","console","log","history","push","alert","componentDidMount","clearFields","render","styleLoginField","stylePasswordField","styleRepeatPasswordField","repeatField","mapStateToProps","registrationBlock","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport './registration-page.css';\r\n\r\nimport {compose} from \"../../utils\";\r\nimport {connect} from \"react-redux\";\r\nimport {Link} from 'react-router-dom';\r\nimport withLibraryService from \"../../hoc\";\r\nimport { withRouter } from \"react-router\";\r\nimport {\r\n    registrationsClearFields,\r\n    registrationUpdateLoginField,\r\n    registrationUpdatePasswordField,\r\n    registrationUpdateRepeatPasswordField\r\n} from \"../../actions/registration-actions\";\r\n\r\nclass RegistrationPage extends Component{\r\n\r\n    // necessary for error handling and pointless, in my opinion, for rendering to the global state\r\n    state = {\r\n        isLoginError : false,\r\n        isPasswordError : false,\r\n        isRepeatPasswordError : false,\r\n    };\r\n\r\n    //regular expressions for checking entered data\r\n    regExpLogin = new RegExp(\"^[A-Za-zА-Яа-я0-9]+$\");\r\n    regExpPassword = new RegExp(\"^[A-Za-zА-Яа-я0-9]+$\");\r\n\r\n    //error message\r\n    errorLoginMessage = \"The username must be at least 4 characters long\";\r\n    errorPasswordMessage = \"The password must be at least 8 characters and must contain letters in different case and numbers\";\r\n    errorRepeatPasswordMessage = \"Repeat password must match the value entered above\";\r\n\r\n    componentDidMount() {\r\n        this.props.clearFields();\r\n    }\r\n\r\n    validateLogin = (login, isErrorField) => {\r\n        let isError = !this.regExpLogin.test(login);\r\n        isError = !isError ? (login.length < 4) : isError;\r\n        this.changeErrorState(isErrorField,  isError);\r\n    };\r\n\r\n    validatePassword = (password, isErrorField) => {\r\n        let isError = !this.regExpPassword.test(password);\r\n        isError = !isError ? (password.length < 8) : isError;\r\n        this.changeErrorState(isErrorField,  isError);\r\n    };\r\n\r\n    validateRepeatPassword = (repeatPassword, isErrorField) => {\r\n        let isError = !this.regExpPassword.test(repeatPassword);\r\n        isError = !isError ? ((repeatPassword.length < 8) || repeatPassword.localeCompare(this.props.passwordField)) : isError;\r\n        this.changeErrorState(isErrorField,  isError);\r\n    };\r\n\r\n    changeErrorState = (isErrorField, value) => {\r\n        this.setState({\r\n            [isErrorField] : value\r\n        })\r\n    };\r\n\r\n    loginChange = event => {\r\n        event.preventDefault();\r\n        this.validateLogin(event.target.value, \"isLoginError\");\r\n        this.props.changeLogin(event.target.value);\r\n    };\r\n\r\n    passwordChange = event => {\r\n        event.preventDefault();\r\n        this.validatePassword(event.target.value, \"isPasswordError\");\r\n        this.props.changePassword(event.target.value);\r\n    };\r\n\r\n    repeatPasswordChange = event => {\r\n        event.preventDefault();\r\n        this.validateRepeatPassword(event.target.value, \"isRepeatPasswordError\");\r\n        this.props.changeRepeatPassword(event.target.value);\r\n    };\r\n\r\n    onSubmit = async event => {\r\n        event.preventDefault();\r\n\r\n        const {loginField, passwordField, repeatPasswordField} = this.props;\r\n        await this.validateLogin(loginField, \"isLoginError\");\r\n        await this.validatePassword(passwordField, \"isPasswordError\");\r\n        await this.validateRepeatPassword(repeatPasswordField, \"isRepeatPasswordError\");\r\n        const isError = this.state.isLoginError || this.state.isPasswordError || this.state.isRepeatPasswordError;\r\n\r\n        if(!isError) {\r\n            const admin = {\r\n                login : loginField,\r\n                password : passwordField\r\n            };\r\n\r\n            let result = await this.props.libraryService.addAdmin(admin);\r\n            console.log(result);\r\n\r\n            if(result) {\r\n                this.props.history.push('/authorization');\r\n            } else {\r\n                alert(\"Get some problems when trying add user\");\r\n            }\r\n        }\r\n    };\r\n\r\n    render () {\r\n\r\n        const styleLoginField = this.state.isLoginError ? \"form-control red-box\" : \"form-control\";\r\n        const stylePasswordField = this.state.isPasswordError ? \"form-control red-box\" : \"form-control\";\r\n        const styleRepeatPasswordField = this.state.isRepeatPasswordError ? \"form-control red-box\" : \"form-control\";\r\n\r\n        return (\r\n            <div className=\"reg-screen\">\r\n                <div className=\"reg-block align-middle\">\r\n\r\n                    <div className=\"reg-header ml-4 pl-2 mr-5 pr-3 mt-2 d-flex\">\r\n                        <Link className=\"btn btn-outline-dark float-left item-control\"\r\n                            to=\"/authorization\">\r\n                            <i className=\"fa fa-arrow-left\" aria-hidden=\"true\"/>\r\n                        </Link>\r\n                        <h5 className=\"align-baseline\">Registration</h5>\r\n                    </div>\r\n\r\n\r\n                    <form onSubmit={this.onSubmit}>\r\n                        <label className=\"label-block\">\r\n                            Login\r\n                            <input type=\"text\" placeholder=\"Write your future login\" className={styleLoginField} onChange={this.loginChange} value={this.props.loginField}/>\r\n                        </label>\r\n                        {this.state.isLoginError ? <div className=\"red-text\">{this.errorLoginMessage}</div> : null}\r\n                        <label className=\"label-block\">\r\n                            Password\r\n                            <input type=\"password\" placeholder=\"Write your future password\" className={stylePasswordField} onChange={this.passwordChange} value={this.props.passwordField}/>\r\n                        </label>\r\n                        {this.state.isPasswordError ? <div className=\"red-text\">{this.errorPasswordMessage}</div> : null}\r\n                        <label className=\"label-block\">\r\n                            Confirm password\r\n                            <input type=\"password\" placeholder=\"Repeat your password\" className={styleRepeatPasswordField} onChange={this.repeatPasswordChange} value={this.props.repeatField}/>\r\n                        </label>\r\n                        {this.state.isRepeatPasswordError ? <div className=\"red-text\">{this.errorRepeatPasswordMessage}</div> : null}\r\n                        <button type=\"submit\" className=\"btn btn-info auth-button mb-3 mt-3\">Registration</button>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nconst mapStateToProps = ({registrationBlock}) => {\r\n    return {\r\n        loginField : registrationBlock.loginField,\r\n        passwordField : registrationBlock.passwordField,\r\n        repeatPasswordField : registrationBlock.repeatPasswordField\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        clearFields : () => {dispatch(registrationsClearFields())},\r\n        changeLogin : (value) => {dispatch(registrationUpdateLoginField(value))},\r\n        changePassword : (value) => {dispatch(registrationUpdatePasswordField(value))},\r\n        changeRepeatPassword : (value) => {dispatch(registrationUpdateRepeatPasswordField(value))}\r\n    }\r\n};\r\n\r\nexport default  compose(\r\n    withRouter,\r\n    withLibraryService(),\r\n    connect(mapStateToProps, mapDispatchToProps)\r\n)(RegistrationPage);"]},"metadata":{},"sourceType":"module"}