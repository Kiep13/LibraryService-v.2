{"ast":null,"code":"var _jsxFileName = \"D:\\\\libraryservice\\\\frontpages\\\\src\\\\components\\\\publishers-page\\\\publishers-page.js\";\nimport React, { Component } from \"react\";\nimport \"./publisher-page.css\";\nimport Header from \"../header\";\nimport { compose } from \"../../utils\";\nimport { connect } from \"react-redux\";\nimport withLibraryService from \"../../hoc\";\nimport Spinner from '../spinner';\nimport { publishersRequested, publishersLoaded, publishersShowAddWindow, publishersShowEditWindow, publishersUpdateAddField, publishersUpdateEditField, publishersUpdateSelectedItem } from \"../../actions/publishers-actions\";\nimport { Redirect } from \"react-router-dom\";\n\nclass PublishersPage extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      formError: {\n        addPublisher: \"\",\n        editPublisher: \"\"\n      },\n      isAddPublisherError: false,\n      isEditPublisherError: false\n    };\n    this.errorPublisherMessage = \"The length of the publisher's name must be at least 3\";\n\n    this.getAllPublishers = async () => {\n      const publishers = await this.props.libraryService.getAllPublishers();\n      this.props.onLoaded(publishers);\n    };\n\n    this.validatePublisher = (publisher, messageField, isErrorField, errorMess) => {\n      const isError = publisher.lenbits < 3;\n      const message = isError ? errorMess : \"\";\n      this.changeErrorState(messageField, isErrorField, message, isError);\n    };\n\n    this.changeErrorState = (messageField, isErrorField, message, value) => {\n      this.setState({\n        formError: {\n          [messageField]: message\n        },\n        [isErrorField]: value\n      });\n    };\n\n    this.changeAddPublisher = event => {\n      event.preventDefault();\n      this.validateGenre(event.target.value, \"addPublisher\", \"isAddPublisherError\", this.errorPublisherMessage);\n      this.props.changeAddField(event.target.value);\n    };\n\n    this.changeEditPublisher = event => {\n      event.preventDefault();\n      this.validateGenre(event.target.value, \"editPublisher\", \"isEditPublisherError\", this.errorPublisherMessage);\n      this.props.changeEditField(event.target.value);\n    };\n\n    this.onAddButtonClick = async event => {\n      event.preventDefault();\n\n      if (!this.props.isEditWindow) {\n        const value = this.props.isAddWindow;\n\n        if (value) {\n          this.changeErrorState(\"addPublisher\", \"isAddPublisherError\", \"\", false);\n          this.props.onAddFieldChange(\"\");\n        }\n\n        this.props.changeAddWindow(!value);\n      } else {\n        alert(\"You have opened edit window\");\n      }\n    };\n\n    this.onEditButtonClick = async event => {\n      event.preventDefault();\n\n      if (!this.props.isAddWindow) {\n        if (this.props.selectedItem != null) {\n          const value = this.props.isEditWindow;\n          this.props.changeEditWindow(!value);\n        } else {\n          alert(\"You did not choose genre!\");\n        }\n      } else {\n        alert(\"You have opened add window\");\n      }\n    };\n\n    this.onDeleteButtonClick = async event => {\n      event.preventDefault();\n\n      if (this.props.selectedItem != null) {\n        await this.props.libraryService.deletePublisher(this.props.selectedItem);\n        this.props.onRequest();\n        this.getAllPublishers();\n      } else {\n        alert(\"You did not choose genre!\");\n      }\n    };\n\n    this.addPublisher = async event => {\n      event.preventDefault();\n      await this.validateGenre(event.target.value, \"addPublisher\", \"isAddPublisherError\", this.errorPublisherMessage);\n\n      if (this.state.isAddPublisherError) {\n        const publisher = {\n          publisher: this.props.addPublisher\n        };\n        await this.props.libraryService.addPublisher(publisher);\n        this.props.onRequest();\n        this.getAllPublishers();\n      }\n    };\n\n    this.editPublisher = async event => {\n      event.preventDefault();\n      await this.validateGenre(event.target.value, \"editPublisher\", \"isEditPublisherError\", this.errorPublisherMessage);\n\n      if (!this.state.isEditPublisherError) {\n        if (this.props.selectedItem != null) {\n          const publisher = {\n            id: this.props.selectedItem,\n            publisher: this.props.editPublisher\n          };\n          await this.props.libraryService.editPublisher(publisher);\n          this.props.onRequest();\n          this.getAllPublishers();\n        } else {\n          alert(\"You did not choose genre!\");\n        }\n      }\n    };\n\n    this.selectedRow = (id, text) => {\n      this.props.changeItem({\n        id,\n        text\n      });\n      this.changeErrorState(\"editPublisher\", \"isEditPublisherError\", \"\", false);\n    };\n  }\n\n  componentDidMount() {\n    this.props.onRequest();\n    this.getAllPublishers();\n  }\n\n  render() {\n    if (!this.props.isLoggedIn) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/authorization\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 20\n        }\n      });\n    }\n\n    if (this.props.loading) {\n      return /*#__PURE__*/React.createElement(Spinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 20\n        }\n      });\n    }\n\n    const rows = this.props.publishers.map(({\n      id,\n      publisher\n    }) => {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"radio\",\n        name: \"object_id\",\n        value: id,\n        onClick: () => {\n          this.selectedRow(id, publisher);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 25\n        }\n      })), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 21\n        }\n      }, publisher));\n    });\n    const styleAddBlock = this.state.isAddPublisherError ? \"form-control d-inline-block form-label red-box\" : \"form-control d-inline-block form-label\";\n    const addWindow = !this.props.isAddWindow ? null : /*#__PURE__*/React.createElement(\"div\", {\n      id: \"add-publisher-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card card-body mb-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.addPublisher,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"publishers-form  d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Write new publisher here...\",\n      className: \"form-control d-inline-block form-label\",\n      onChange: this.changeAddPublisher,\n      value: this.props.addPublisher,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-info auth-button  form-button mt-0 ml-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 29\n      }\n    }, \"Add\")))));\n    const editWindow = !this.props.isEditWindow ? null : /*#__PURE__*/React.createElement(\"div\", {\n      id: \"edit-publisher-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.editPublisher,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"publishers-form  d-flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      placeholder: \"Write new genre here...\",\n      className: \"form-control d-inline-block form-label\",\n      onChange: this.changeEditPublisher,\n      value: this.props.editPublisher,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-info auth-button  form-button mt-0 ml-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 29\n      }\n    }, \"Update\")))));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"main\", {\n      role: \"main\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container publishers-page\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 25\n      }\n    }, \"Publishers\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"publishers-tools\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-outline-danger float-right my-1 item-control\",\n      onClick: this.onDeleteButtonClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-trash-o\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-outline-warning float-right my-1 item-control\",\n      onClick: this.onEditButtonClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-pencil\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-outline-success float-right my-1 item-control\",\n      onClick: this.onAddButtonClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-plus\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 33\n      }\n    }))), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 25\n      }\n    }), addWindow, editWindow, /*#__PURE__*/React.createElement(\"table\", {\n      className: \"table\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 33\n      }\n    }, \"#\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 33\n      }\n    }, \"Name\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 29\n      }\n    }, rows)))));\n  }\n\n}\n\nconst mapStateToProps = ({\n  publishersList,\n  authorizationBlock\n}) => {\n  return {\n    isLoggedIn: authorizationBlock.isLoggedIn,\n    publishers: publishersList.publishers,\n    loading: publishersList.loading,\n    isAddWindow: publishersList.isAddWindow,\n    isEditWindow: publishersList.isEditWindow,\n    addPublisher: publishersList.addPublisher,\n    editPublisher: publishersList.editPublisher,\n    selectedItem: publishersList.selectedItem\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onRequest: () => {\n      dispatch(publishersRequested());\n    },\n    onLoaded: newPublishers => {\n      dispatch(publishersLoaded(newPublishers));\n    },\n    changeAddWindow: value => {\n      dispatch(publishersShowAddWindow(value));\n    },\n    changeEditWindow: value => {\n      dispatch(publishersShowEditWindow(value));\n    },\n    changeAddField: value => {\n      dispatch(publishersUpdateAddField(value));\n    },\n    changeEditField: value => {\n      dispatch(publishersUpdateEditField(value));\n    },\n    changeItem: item => {\n      dispatch(publishersUpdateSelectedItem(item));\n    }\n  };\n};\n\nexport default compose(withLibraryService(), connect(mapStateToProps, mapDispatchToProps))(PublishersPage);","map":{"version":3,"sources":["D:/libraryservice/frontpages/src/components/publishers-page/publishers-page.js"],"names":["React","Component","Header","compose","connect","withLibraryService","Spinner","publishersRequested","publishersLoaded","publishersShowAddWindow","publishersShowEditWindow","publishersUpdateAddField","publishersUpdateEditField","publishersUpdateSelectedItem","Redirect","PublishersPage","state","formError","addPublisher","editPublisher","isAddPublisherError","isEditPublisherError","errorPublisherMessage","getAllPublishers","publishers","props","libraryService","onLoaded","validatePublisher","publisher","messageField","isErrorField","errorMess","isError","lenbits","message","changeErrorState","value","setState","changeAddPublisher","event","preventDefault","validateGenre","target","changeAddField","changeEditPublisher","changeEditField","onAddButtonClick","isEditWindow","isAddWindow","onAddFieldChange","changeAddWindow","alert","onEditButtonClick","selectedItem","changeEditWindow","onDeleteButtonClick","deletePublisher","onRequest","id","selectedRow","text","changeItem","componentDidMount","render","isLoggedIn","loading","rows","map","styleAddBlock","addWindow","editWindow","mapStateToProps","publishersList","authorizationBlock","mapDispatchToProps","dispatch","newPublishers","item"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\r\nimport \"./publisher-page.css\";\r\nimport Header from \"../header\";\r\nimport {compose} from \"../../utils\";\r\nimport {connect} from \"react-redux\";\r\nimport withLibraryService from \"../../hoc\";\r\nimport Spinner from '../spinner';\r\nimport {\r\n    publishersRequested,\r\n    publishersLoaded,\r\n    publishersShowAddWindow,\r\n    publishersShowEditWindow,\r\n    publishersUpdateAddField,\r\n    publishersUpdateEditField,\r\n    publishersUpdateSelectedItem\r\n} from \"../../actions/publishers-actions\";\r\nimport {Redirect} from \"react-router-dom\";\r\n\r\nclass PublishersPage extends Component {\r\n\r\n    // necessary for error handling and pointless, in my opinion, for rendering to the global state\r\n    state = {\r\n        formError : {\r\n            addPublisher : \"\",\r\n            editPublisher : \"\",\r\n        },\r\n        isAddPublisherError : false,\r\n        isEditPublisherError : false\r\n    };\r\n\r\n    //error message\r\n    errorPublisherMessage = \"The length of the publisher's name must be at least 3\";\r\n\r\n    componentDidMount() {\r\n        this.props.onRequest();\r\n        this.getAllPublishers();\r\n    }\r\n\r\n    getAllPublishers = async () => {\r\n        const publishers = await this.props.libraryService.getAllPublishers();\r\n        this.props.onLoaded(publishers);\r\n    };\r\n\r\n    validatePublisher= (publisher, messageField, isErrorField, errorMess) => {\r\n        const isError = publisher.lenbits < 3;\r\n        const message = isError ? errorMess : \"\";\r\n        this.changeErrorState(messageField, isErrorField, message, isError);\r\n    };\r\n\r\n    changeErrorState = (messageField, isErrorField, message, value) => {\r\n        this.setState({\r\n            formError : {\r\n                [messageField] : message\r\n            },\r\n            [isErrorField] : value\r\n        })\r\n    };\r\n\r\n    changeAddPublisher = event => {\r\n        event.preventDefault();\r\n        this.validateGenre(event.target.value, \"addPublisher\", \"isAddPublisherError\", this.errorPublisherMessage);\r\n        this.props.changeAddField(event.target.value);\r\n    };\r\n\r\n    changeEditPublisher = event => {\r\n        event.preventDefault();\r\n        this.validateGenre(event.target.value, \"editPublisher\", \"isEditPublisherError\", this.errorPublisherMessage);\r\n        this.props.changeEditField(event.target.value);\r\n    };\r\n\r\n    onAddButtonClick = async event => {\r\n        event.preventDefault();\r\n        if(!this.props.isEditWindow) {\r\n            const value = this.props.isAddWindow;\r\n            if(value) {\r\n                this.changeErrorState(\"addPublisher\", \"isAddPublisherError\", \"\", false);\r\n                this.props.onAddFieldChange(\"\");\r\n            }\r\n            this.props.changeAddWindow(!value);\r\n        } else {\r\n            alert(\"You have opened edit window\");\r\n        }\r\n    };\r\n\r\n    onEditButtonClick = async event => {\r\n        event.preventDefault();\r\n        if(!this.props.isAddWindow) {\r\n            if (this.props.selectedItem != null) {\r\n                const value = this.props.isEditWindow;\r\n                this.props.changeEditWindow(!value);\r\n            } else {\r\n                alert(\"You did not choose genre!\");\r\n            }\r\n        } else {\r\n            alert(\"You have opened add window\");\r\n        }\r\n    };\r\n\r\n    onDeleteButtonClick = async event => {\r\n        event.preventDefault();\r\n\r\n        if(this.props.selectedItem != null) {\r\n            await this.props.libraryService.deletePublisher(this.props.selectedItem);\r\n            this.props.onRequest();\r\n            this.getAllPublishers();\r\n        } else {\r\n            alert(\"You did not choose genre!\");\r\n        }\r\n    };\r\n\r\n    addPublisher = async event => {\r\n        event.preventDefault();\r\n\r\n        await this.validateGenre(event.target.value, \"addPublisher\", \"isAddPublisherError\", this.errorPublisherMessage);\r\n        if(this.state.isAddPublisherError) {\r\n            const publisher = {\r\n                publisher : this.props.addPublisher\r\n            };\r\n\r\n            await this.props.libraryService.addPublisher(publisher);\r\n            this.props.onRequest();\r\n            this.getAllPublishers();\r\n        }\r\n    };\r\n\r\n    editPublisher = async event => {\r\n        event.preventDefault();\r\n\r\n        await this.validateGenre(event.target.value, \"editPublisher\", \"isEditPublisherError\", this.errorPublisherMessage);\r\n        if(!this.state.isEditPublisherError) {\r\n            if(this.props.selectedItem != null) {\r\n                const publisher = {\r\n                    id : this.props.selectedItem,\r\n                    publisher : this.props.editPublisher\r\n                };\r\n\r\n                await this.props.libraryService.editPublisher(publisher);\r\n                this.props.onRequest();\r\n                this.getAllPublishers();\r\n            } else {\r\n                alert(\"You did not choose genre!\");\r\n            }\r\n        }\r\n    };\r\n\r\n    selectedRow = (id, text) => {\r\n        this.props.changeItem({id, text});\r\n        this.changeErrorState(\"editPublisher\", \"isEditPublisherError\", \"\", false);\r\n    };\r\n\r\n    render() {\r\n\r\n        if(!this.props.isLoggedIn) {\r\n            return <Redirect to='/authorization'/>\r\n        }\r\n\r\n        if(this.props.loading) {\r\n            return <Spinner/>;\r\n        }\r\n\r\n        const rows = this.props.publishers.map(({id, publisher}) => {\r\n            return (\r\n                <tr key={id}>\r\n                    <td><input type=\"radio\" name=\"object_id\" value={id} onClick={() => {this.selectedRow(id, publisher)}}/></td>\r\n                    <td>{publisher}</td>\r\n                </tr>\r\n            )\r\n        });\r\n\r\n        const styleAddBlock = this.state.isAddPublisherError ? \"form-control d-inline-block form-label red-box\" : \"form-control d-inline-block form-label\";\r\n        const addWindow = !this.props.isAddWindow ? null :\r\n            <div id=\"add-publisher-block\">\r\n                <div className=\"card card-body mb-2\">\r\n                    <form onSubmit={this.addPublisher}>\r\n                        <div className=\"publishers-form  d-flex\">\r\n                            <input type=\"text\" placeholder=\"Write new publisher here...\" className=\"form-control d-inline-block form-label\" onChange={this.changeAddPublisher} value={this.props.addPublisher}/>\r\n                            <button type=\"submit\" className=\"btn btn-info auth-button  form-button mt-0 ml-2\">Add</button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>;\r\n\r\n        const editWindow = !this.props.isEditWindow ? null :\r\n            <div id=\"edit-publisher-block\">\r\n                <div className=\"card card-body\">\r\n                    <form onSubmit={this.editPublisher}>\r\n                        <div className=\"publishers-form  d-flex\">\r\n                            <input type=\"text\" placeholder=\"Write new genre here...\" className=\"form-control d-inline-block form-label\" onChange={this.changeEditPublisher} value={this.props.editPublisher}/>\r\n                            <button type=\"submit\" className=\"btn btn-info auth-button  form-button mt-0 ml-2\">Update</button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>;\r\n\r\n        return (\r\n            <div>\r\n                <Header/>\r\n\r\n                <main role=\"main\">\r\n\r\n                    <div className=\"container publishers-page\">\r\n                        <h1>Publishers</h1>\r\n\r\n                        <div className=\"publishers-tools\">\r\n                            <button className=\"btn btn-outline-danger float-right my-1 item-control\" onClick={this.onDeleteButtonClick}>\r\n                                <i className=\"fa fa-trash-o\"/>\r\n                            </button>\r\n\r\n                            <button className=\"btn btn-outline-warning float-right my-1 item-control\" onClick={this.onEditButtonClick}>\r\n                                <i className=\"fa fa-pencil\"/>\r\n                            </button>\r\n\r\n                            <button className=\"btn btn-outline-success float-right my-1 item-control\" onClick={this.onAddButtonClick}>\r\n                                <i className=\"fa fa-plus\"/>\r\n                            </button>\r\n                        </div>\r\n\r\n                        <br/>\r\n                        <br/>\r\n\r\n                        {addWindow}\r\n\r\n                        {editWindow}\r\n\r\n                        <table className=\"table\">\r\n                            <thead>\r\n                            <tr>\r\n                                <th>#</th>\r\n                                <th>Name</th>\r\n                            </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                            {rows}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n\r\n                </main>\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nconst mapStateToProps = ({publishersList, authorizationBlock}) => {\r\n    return {\r\n        isLoggedIn : authorizationBlock.isLoggedIn,\r\n        publishers : publishersList.publishers,\r\n        loading : publishersList.loading,\r\n        isAddWindow : publishersList.isAddWindow,\r\n        isEditWindow : publishersList.isEditWindow,\r\n        addPublisher : publishersList.addPublisher,\r\n        editPublisher : publishersList.editPublisher,\r\n        selectedItem : publishersList.selectedItem\r\n    }\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        onRequest : () => {dispatch(publishersRequested())},\r\n        onLoaded : (newPublishers) => {dispatch(publishersLoaded(newPublishers))},\r\n        changeAddWindow : (value) => {dispatch(publishersShowAddWindow(value))},\r\n        changeEditWindow : (value) => {dispatch(publishersShowEditWindow(value))},\r\n        changeAddField : (value) => {dispatch(publishersUpdateAddField(value))},\r\n        changeEditField : (value) => {dispatch(publishersUpdateEditField(value))},\r\n        changeItem : (item) => {dispatch(publishersUpdateSelectedItem(item))}\r\n    }\r\n};\r\n\r\nexport default compose(\r\n        withLibraryService(),\r\n        connect(mapStateToProps, mapDispatchToProps)\r\n    )(PublishersPage);\r\n"]},"metadata":{},"sourceType":"module"}